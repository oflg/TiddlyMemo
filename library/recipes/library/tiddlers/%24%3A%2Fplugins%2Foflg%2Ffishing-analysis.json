{"author":"oflg","core-version":">=5.2.3","dependents":"$:/plugins/oflg/fishing $:/plugins/Gk0Wk/echarts","description":"Analysis for Fishing","list":"readme license","name":"Fishing Analysis","plugin-type":"plugin","source":"https://github.com/oflg/fishing-analysis","title":"$:/plugins/oflg/fishing-analysis","version":"0.5.0","type":"application/json","text":"{\"tiddlers\":{\"$:/plugins/oflg/fishing-analysis/license\":{\"title\":\"$:/plugins/oflg/fishing-analysis/license\",\"text\":\"MIT License\\n\\nCopyright (c) 2022 oflg\\n\\nPermission is hereby granted, free of charge, to any person obtaining a copy\\nof this software and associated documentation files (the \\\"Software\\\"), to deal\\nin the Software without restriction, including without limitation the rights\\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\\ncopies of the Software, and to permit persons to whom the Software is\\nfurnished to do so, subject to the following conditions:\\n\\nThe above copyright notice and this permission notice shall be included in all\\ncopies or substantial portions of the Software.\\n\\nTHE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\\nSOFTWARE.\",\"type\":\"text/plain\"},\"$:/plugins/oflg/fishing-analysis/readme\":{\"title\":\"$:/plugins/oflg/fishing-analysis/readme\",\"text\":\"Installation and usage tutorial is available at [[TiddlyMemo Manual|https://tiddlymemo.org/manual/#Included%20plugins]].\\n\\n可在 [[墨屉手册|https://tiddlymemo.org/manual/zh-Hans#相关插件]] 查看安装使用教程。\",\"type\":\"text/vnd.tiddlywiki\"},\"$:/plugins/oflg/fishing-analysis/calendar/calendar.js\":{\"title\":\"$:/plugins/oflg/fishing-analysis/calendar/calendar.js\",\"text\":\"/*\\\\\\nCalendar for Fishing.\\n\\\\*/\\n\\nexports.shouldUpdate = \\\"[{$:/temp/fishing!!year}]\\\";\\n\\nexports.onUpdate = function (myChart) {\\n    var year = Number($tw.wiki.filterTiddlers(\\\"[{$:/temp/fishing!!year}]\\\")[0]) || new Date().getFullYear();\\n\\n    var reviewDayArry = [],\\n        dueDayArry = [],\\n        undueDayArry = [];\\n\\n    var reviewArry = $tw.wiki.filterTiddlers(\\\"[has[history]]\\\"),\\n        dueArry = $tw.wiki.filterTiddlers(\\\"[subfilter{$:/config/fishingpond/duepond}]\\\"),\\n        undueArry = $tw.wiki.filterTiddlers(\\\"[subfilter{$:/config/fishingpond/unduepond}]\\\");\\n\\n    function getJson(jsonString) {\\n        jsonString = jsonString || \\\"[]\\\";\\n        var result = [];\\n        try {\\n            result = JSON.parse(jsonString);\\n        } catch (error) {\\n            console.log(\\\"JSON error : \\\" + error);\\n            console.log(jsonString);\\n        }\\n        return result;\\n    }\\n\\n    function twTime2twDayArry(twTime, dayArry) {\\n        var day = $tw.wiki.filterTiddlers(\\\"[[\\\" + twTime + \\\"]format:date[YYYY-0MM-0DD]]\\\")[0];\\n\\n        var dayIndex = dayArry.findIndex(function (df) {\\n            return df[0] == day;\\n        });\\n\\n        if (dayIndex == -1) {\\n            dayArry.push([\\n                day,\\n                1\\n            ]);\\n\\n        } else {\\n            dayArry.splice(dayIndex, 1, [\\n                day,\\n                dayArry[dayIndex][1] + 1\\n            ]);\\n        }\\n    }\\n\\n    function title2data(titleArry, dataArry) {\\n\\n        for (var t = 0; t < titleArry.length; t++) {\\n\\n            var dueTiddler = $tw.wiki.getTiddler(titleArry[t]);\\n\\n            var dueTime = dueTiddler.fields[\\\"due\\\"];\\n\\n            if (dueTime && (dueTime.slice(0, 4) == year)) {\\n                twTime2twDayArry(dueTime, dataArry);\\n            }\\n        }\\n    }\\n\\n    for (var r = 0; r < reviewArry.length; r++) {\\n\\n        var reviewTiddler = $tw.wiki.getTiddler(reviewArry[r]);\\n\\n        var reviewTime = reviewTiddler.fields[\\\"review\\\"];\\n\\n        if (reviewTime && (reviewTime.slice(0, 4) == year)) {\\n            twTime2twDayArry(reviewTime, reviewDayArry);\\n        }\\n\\n        var historyArry = getJson(reviewTiddler.fields[\\\"history\\\"]);\\n\\n        if (historyArry.length > 0) {\\n\\n            for (var h = 0; h < historyArry.length; h++) {\\n\\n                var historyReviewTime = historyArry[h].review;\\n\\n                if (historyReviewTime && (historyReviewTime.slice(0, 4) == year)) {\\n                    twTime2twDayArry(historyReviewTime, reviewDayArry);\\n                }\\n            }\\n        }\\n    }\\n\\n    // history2data(reviewArry, reviewDayArry);\\n    title2data(dueArry, dueDayArry);\\n    title2data(undueArry, undueDayArry);\\n\\n    var calendarLan = $tw.wiki.filterTiddlers(\\\"[{$:/language/fishing-analysis/calendar}]\\\")[0],\\n        reviewLan = $tw.wiki.filterTiddlers(\\\"[{$:/language/fishing-analysis/history}]\\\")[0],\\n        dueLan = $tw.wiki.filterTiddlers(\\\"[{$:/language/fishing-analysis/due}]\\\")[0],\\n        undueLan = $tw.wiki.filterTiddlers(\\\"[{$:/language/fishing-analysis/undue}]\\\")[0],\\n        year1stLan = $tw.wiki.filterTiddlers(\\\"[{$:/language/fishing-analysis/year1st}]\\\")[0],\\n        year2stLan = $tw.wiki.filterTiddlers(\\\"[{$:/language/fishing-analysis/year2st}]\\\")[0];\\n\\n    var option = {\\n        tooltip: {\\n            trigger: \\\"item\\\",\\n            formatter: '{a}<br>{c}'\\n        },\\n        toolbox: {\\n            show: true,\\n            orient: \\\"herizontal\\\",\\n            itemSize: 8,\\n            feature: {\\n                mark: { show: true },\\n                restore: { show: true },\\n                saveAsImage: {\\n                    show: true,\\n                    name: calendarLan\\n                }\\n            }\\n        },\\n        legend: {\\n            top: \\\"0\\\",\\n            height: \\\"10%\\\",\\n            left: \\\"center\\\",\\n            data: [reviewLan, dueLan, undueLan]\\n        },\\n        visualMap: {\\n            seriesIndex: [0, 1],\\n            min: 0,\\n            max: 10,\\n            show: false,\\n            calculable: true,\\n            orient: 'vertical',\\n            top: 'center',\\n            inRange: {\\n                color: ['rgba(136,255,136,0)', '#8f8']\\n            }\\n        },\\n        calendar: [\\n            {\\n                top: \\\"15%\\\",\\n                left: \\\"center\\\",\\n                width: \\\"80%\\\",\\n                height: \\\"35%\\\",\\n                range: [year + \\\"-01-01\\\", year + \\\"-06-30\\\"],\\n                splitLine: {\\n                    show: true,\\n                    lineStyle: {\\n                        width: 1,\\n                        type: \\\"solid\\\"\\n                    }\\n                },\\n                yearLabel: {\\n                    formatter: year1stLan\\n                },\\n                itemStyle: {\\n                    borderWidth: 1,\\n                }\\n            },\\n            {\\n                top: \\\"60%\\\",\\n                left: \\\"center\\\",\\n                width: \\\"80%\\\",\\n                height: \\\"35%\\\",\\n                range: [year + \\\"-07-01\\\", year + \\\"-12-31\\\"],\\n                splitLine: {\\n                    show: true,\\n                    lineStyle: {\\n                        width: 1,\\n                        type: \\\"solid\\\"\\n                    }\\n                },\\n                yearLabel: {\\n                    formatter: year2stLan\\n                },\\n                itemStyle: {\\n                    borderWidth: 1,\\n                }\\n            }\\n        ],\\n        series: [\\n            {\\n                name: reviewLan,\\n                type: \\\"heatmap\\\",\\n                coordinateSystem: \\\"calendar\\\",\\n                data: reviewDayArry,\\n                itemStyle: {\\n                    color: \\\"#8f8\\\"\\n                }\\n            },\\n            {\\n                name: reviewLan,\\n                type: \\\"heatmap\\\",\\n                coordinateSystem: \\\"calendar\\\",\\n                calendarIndex: 1,\\n                data: reviewDayArry,\\n                itemStyle: {\\n                    color: \\\"#8f8\\\"\\n                }\\n            },\\n            {\\n                name: dueLan,\\n                type: \\\"scatter\\\",\\n                coordinateSystem: \\\"calendar\\\",\\n                data: dueDayArry,\\n                symbolSize: function (val) {\\n                    return val[1] <= 20 ? val[1] / 2 : 10;\\n                },\\n                showEffectOn: \\\"render\\\",\\n                rippleEffect: {\\n                    brushType: \\\"stroke\\\"\\n                },\\n                itemStyle: {\\n                    opacity: 0.8,\\n                    color: \\\"#f88\\\",\\n                    shadowBlur: 10,\\n                    shadowColor: \\\"#333\\\"\\n                },\\n                zlevel: 1\\n            },\\n            {\\n                name: dueLan,\\n                type: \\\"scatter\\\",\\n                coordinateSystem: \\\"calendar\\\",\\n                calendarIndex: 1,\\n                data: dueDayArry,\\n                symbolSize: function (val) {\\n                    return val[1] <= 20 ? val[1] / 2 : 10;\\n                },\\n                showEffectOn: \\\"render\\\",\\n                rippleEffect: {\\n                    brushType: \\\"stroke\\\"\\n                },\\n                itemStyle: {\\n                    opacity: 0.8,\\n                    color: \\\"#f88\\\",\\n                    shadowBlur: 10,\\n                    shadowColor: \\\"#333\\\"\\n                },\\n                zlevel: 1\\n            },\\n            {\\n                name: undueLan,\\n                type: \\\"scatter\\\",\\n                coordinateSystem: \\\"calendar\\\",\\n                data: undueDayArry,\\n                symbolSize: function (val) {\\n                    return val[1] <= 20 ? val[1] / 2 : 10;\\n                },\\n                showEffectOn: \\\"render\\\",\\n                rippleEffect: {\\n                    brushType: \\\"stroke\\\"\\n                },\\n                itemStyle: {\\n                    opacity: 0.8,\\n                    color: \\\"#88f\\\",\\n                    shadowBlur: 10,\\n                    shadowColor: \\\"#333\\\"\\n                },\\n                zlevel: 1\\n            },\\n            {\\n                name: undueLan,\\n                type: \\\"scatter\\\",\\n                coordinateSystem: \\\"calendar\\\",\\n                calendarIndex: 1,\\n                data: undueDayArry,\\n                symbolSize: function (val) {\\n                    return val[1] <= 20 ? val[1] / 2 : 10;\\n                },\\n                showEffectOn: \\\"render\\\",\\n                rippleEffect: {\\n                    brushType: \\\"stroke\\\"\\n                },\\n                itemStyle: {\\n                    opacity: 0.8,\\n                    color: \\\"#88f\\\",\\n                    shadowBlur: 10,\\n                    shadowColor: \\\"#333\\\"\\n                },\\n                zlevel: 1\\n            }\\n        ]\\n    };\\n\\n    option && myChart.setOption(option);\\n\\n    myChart.on('click', 'series', function (params) {\\n\\n        if (params.seriesName == dueLan || params.seriesName == undueLan) {\\n\\n            var day = params.data[0].replace(/\\\\-/g, '');\\n\\n            var filter = \\\"[sameday:due[\\\" + day + \\\"]]\\\";\\n\\n            $tw.rootWidget.invokeActionString('<$action-setfield $tiddler=\\\"$:/temp/advancedsearch\\\" text=\\\"\\\"\\\"' + filter + '\\\"\\\"\\\"/><$action-setfield $tiddler=\\\"$:/temp/advancedsearch/input\\\" text=\\\"\\\"\\\"' + filter + '\\\"\\\"\\\"/><$action-setfield $tiddler=\\\"$:/temp/advancedsearch/refresh\\\" text=\\\"yes\\\"/><$action-setfield $tiddler=\\\"$:/state/tab--1498284803\\\" text=\\\"$:/core/ui/AdvancedSearch/Filter\\\"/>');\\n\\n            new $tw.Story().navigateTiddler(\\\"$:/AdvancedSearch\\\");\\n        }\\n\\n    });\\n};\",\"type\":\"application/javascript\",\"module-type\":\"echarts-component\"},\"$:/plugins/oflg/fishing-analysis/calendar/calendar\":{\"title\":\"$:/plugins/oflg/fishing-analysis/calendar/calendar\",\"tags\":\"$:/tags/SideBar/FishingAnalysis\",\"caption\":\"{{$:/language/fishing-analysis/calendar}}\",\"list-after\":\"$:/plugins/oflg/fishing-analysis/focus\",\"text\":\"<center style=\\\"font-size:20px;\\\">\\n    <$button\\n        set=\\\"$:/temp/fishing!!year\\\"\\n        setTo={{{ [{$:/temp/fishing!!year}subtract[1]!match[-1]] ~[<now YYYY>subtract[1]] }}}\\n        class=\\\"tc-btn-invisible tc-tiddlylink\\\"\\n\\n    >\\n        ◄\\n    </$button> ''<$text text={{{[{$:/temp/fishing!!year}match[]then<now YYYY>else{$:/temp/fishing!!year}]}}}/>'' <$button\\n        set=\\\"$:/temp/fishing!!year\\\"\\n        setTo={{{ [{$:/temp/fishing!!year}add[1]!match[1]] ~[<now YYYY>add[1]] }}}\\n        class=\\\"tc-btn-invisible tc-tiddlylink\\\"\\n\\n    >\\n        ►\\n    </$button>\\n</center>\\n\\n<$echarts\\n    $tiddler=\\\"$:/plugins/oflg/fishing-analysis/calendar/calendar.js\\\"\\n    $height=\\\"380px\\\"\\n    $fillSidebar=\\\"false\\\"\\n/>\"},\"$:/plugins/oflg/fishing-analysis/focus\":{\"title\":\"$:/plugins/oflg/fishing-analysis/focus\",\"tags\":\"$:/tags/SideBar/FishingAnalysis\",\"caption\":\"{{$:/language/fishing-analysis/focus}}\",\"text\":\"<$echarts\\n    $tiddler=\\\"$:/plugins/Gk0Wk/echarts/addons/TheBrain.js\\\"\\n    aliasField=\\\"caption\\\"\\n    levels=1\\n    focussedTiddler={{{ [list[$:/temp/fishing]first[]else[$:/FishingDeck]] }}}\\n    $height=\\\"400px\\\"\\n    $fillSidebar=\\\"false\\\"\\n    graphTitle={{$:/language/fishing-analysis/focustip}}\\n/>\"},\"$:/plugins/oflg/fishing-analysis/icon\":{\"title\":\"$:/plugins/oflg/fishing-analysis/icon\",\"tags\":\"$:/tags/Image\",\"text\":\"<svg width=\\\"22px\\\" height=\\\"22px\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n  <g id=\\\"fishing-analysis\\\">\\n    <path d=\\\"M0 0L1024 0L1024 1024L0 1024L0 0Z\\\" id=\\\"Background\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" stroke=\\\"none\\\" />\\n    <g clip-path=\\\"url(#mask_1)\\\">\\n      <path d=\\\"M260.46 667.8C235.68 625.03 221.5 575.36 221.5 522.38L512 522.38L260.46 667.8L260.46 667.8Z\\\" id=\\\"Shape\\\" fill=\\\"#f88\\\" fill-rule=\\\"evenodd\\\" stroke=\\\"none\\\" />\\n      <path d=\\\"M167.24 713.76L512 522.38L614.06 903.29C581.51 911.99 547.29 916.63 512 916.63C363.72 916.62 234.55 834.76 167.24 713.76L167.24 713.76ZM871.46 314.84C906.78 375.89 927 446.77 927 522.38C927 559.53 922.12 595.55 912.96 629.82L512 522.38L871.46 314.84L871.46 314.84ZM97 522.38C97 293.18 282.8 107.38 512 107.38L512 522.38L97 522.38L97 522.38Z\\\" id=\\\"Shape\\\" fill=\\\"#88f\\\" fill-rule=\\\"evenodd\\\" stroke=\\\"none\\\" />\\n      <path d=\\\"M512 190.38C634.81 190.38 742.04 257.06 799.47 356.19L512 522.38L512 190.38L512 190.38ZM772.62 592.21C747.81 685.06 674.69 758.18 581.83 783L512 522.38L772.62 592.21L772.62 592.21Z\\\" id=\\\"Shape\\\" fill=\\\"#f88\\\" fill-rule=\\\"evenodd\\\" stroke=\\\"none\\\" />\\n      <path d=\\\"M408.25 522.38C408.25 579.679 454.7 626.13 512 626.13C569.299 626.13 615.75 579.68 615.75 522.381C615.75 465.081 569.3 418.63 512 418.63C454.701 418.63 408.25 465.08 408.25 522.38L408.25 522.38Z\\\" id=\\\"Shape\\\" fill=\\\"#8f8\\\" fill-rule=\\\"evenodd\\\" stroke=\\\"none\\\" />\\n    </g>\\n  </g>\\n</svg>\"},\"$:/language/fishing-analysis/analysis\":{\"title\":\"$:/language/fishing-analysis/analysis\",\"text\":\"Analysis\"},\"$:/language/fishing-analysis/calendar\":{\"title\":\"$:/language/fishing-analysis/calendar\",\"text\":\"Calendar\"},\"$:/language/fishing-analysis/history\":{\"title\":\"$:/language/fishing-analysis/history\",\"text\":\"History\"},\"$:/language/fishing-analysis/due\":{\"title\":\"$:/language/fishing-analysis/due\",\"text\":\"Due\"},\"$:/language/fishing-analysis/undue\":{\"title\":\"$:/language/fishing-analysis/undue\",\"text\":\"Undue\"},\"$:/language/fishing-analysis/year1st\":{\"title\":\"$:/language/fishing-analysis/year1st\",\"text\":\"{start} 1st\"},\"$:/language/fishing-analysis/year2st\":{\"title\":\"$:/language/fishing-analysis/year2st\",\"text\":\"{start} 2st\"},\"$:/language/fishing-analysis/focus\":{\"title\":\"$:/language/fishing-analysis/focus\",\"text\":\"Focus\"},\"$:/language/fishing-analysis/focustip\":{\"title\":\"$:/language/fishing-analysis/focustip\",\"text\":\"Learning Focus\"},\"$:/plugins/oflg/fishing-analysis/ui/SideBar/FishingAnalysis\":{\"title\":\"$:/plugins/oflg/fishing-analysis/ui/SideBar/FishingAnalysis\",\"caption\":\"{{$:/language/fishing-analysis/analysis}}\",\"tags\":\"$:/tags/SideBar\",\"text\":\"<div\\n    class=\\\"tc-more-sidebar\\\"\\n>\\n    <$macrocall\\n        $name=\\\"tabs\\\"\\n        tabsList=\\\"[all[shadows+tiddlers]tag[$:/tags/SideBar/FishingAnalysis]!is[draft]]\\\"\\n        default={{{ [all[shadows+tiddlers]tag[$:/tags/SideBar/FishingAnalysis]!is[draft]first[]] }}}\\n        state=\\\"$:/state/tab/fishing-analysis\\\"\\n        class=\\\"tc-vertical tc-sidebar-tabs-more\\\"\\n        explicitState=\\\"$:/state/tab/fishing-analysis\\\"\\n    />\\n</div>\\n\"}}}"}