{"tiddlers":{"$:/plugins/Gk0Wk/focused-tiddler/config":{"title":"$:/plugins/Gk0Wk/focused-tiddler/config","type":"text/vnd.tiddlywiki","text":"<$list filter=\"[[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]]\" variable=\"lang\">\n<$list filter=\"[<lang>search[zh]]\">\n\n; 顶部偏移\n: <$edit-text tiddler=\"$:/plugins/Gk0Wk/focused-tiddler/top-offset\" tag=\"input\" default=\"71\" /> (px)\n: 条目顶部与窗口页面顶部的距离小于偏移量时，该条目会被聚焦。（单位：px）\n\n</$list>\n\n<$list filter=\"[<lang>!search[zh]]\">\n\n; Top Offset\n: <$edit-text tiddler=\"$:/plugins/Gk0Wk/focused-tiddler/top-offset\" tag=\"input\" default=\"71\" /> (px)\n: The entry is focused when the distance between the top of the entry and the top of the window page is less than the offset. (Unit: px)\n\n</$list>\n</$list>\n"},"$:/plugins/Gk0Wk/focused-tiddler/readme":{"title":"$:/plugins/Gk0Wk/focused-tiddler/readme","type":"text/vnd.tiddlywiki","text":"<$list filter=\"[[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]]\" variable=\"lang\">\n<$list filter=\"[<lang>search[zh]]\">\n\n! 聚焦条目\n\n检测你现在正在看的条目，并将其标题存在 `$:/temp/focussedTiddler`。\n\n判定方法：当打开新条目、滚动条目至一定位置（可配置）或者点击条目内容时，及判定为聚焦条目。\n\n> 本插件使用灵活而强大的 <$text text=\"TiddlyWiki\" /> 开发框架 [[Tiddly.ModernDev|https://github.com/tiddly-gittly/Modern.TiddlyDev]]\n\n</$list>\n\n<$list filter=\"[<lang>!search[zh]]\">\n\n! focused-tiddler\n\nDetecting the tiddler you are viewing, and save its title to `$:/temp/focussedTiddler`.\n\nJudgment method: When opening a new tiddler, scrolling the tiddler to a certain position (configurable) or clicking on the content of the tiddler, and judged to be a focused tiddler.\n\n> This plugin uses the flexible and powerful <$text text=\"TiddlyWiki\" /> development framework [[Tiddly.ModernDev|https://github.com/tiddly-gittly/Modern.TiddlyDev]]\n\n</$list>\n</$list>\n"},"$:/plugins/Gk0Wk/focused-tiddler/top-offset":{"title":"$:/plugins/Gk0Wk/focused-tiddler/top-offset","text":"71\n"},"'$:/plugins/Gk0Wk/focused-tiddler/top-offset/hook.js":{"title":"'$:/plugins/Gk0Wk/focused-tiddler/top-offset/hook.js","module-type":"startup","type":"application/javascript","Modern.TiddlyDev#Origin":"hook.ts","text":"\"use strict\";var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__export=(e,t)=>{for(var o in t)__defProp(e,o,{get:t[o],enumerable:!0})},__copyProps=(t,o,r,s)=>{if(o&&\"object\"==typeof o||\"function\"==typeof o)for(let e of __getOwnPropNames(o))__hasOwnProp.call(t,e)||e===r||__defProp(t,e,{get:()=>o[e],enumerable:!(s=__getOwnPropDesc(o,e))||s.enumerable});return t},__toCommonJS=e=>__copyProps(__defProp({},\"__esModule\",{value:!0}),e),hook_exports={},topOffset=(__export(hook_exports,{after:()=>after,name:()=>name,platforms:()=>platforms,startup:()=>startup,synchronous:()=>synchronous}),module.exports=__toCommonJS(hook_exports),71),updateTopOffset=()=>{topOffset=Number($tw.wiki.getTiddlerText(\"$:/plugins/Gk0Wk/focused-tiddler/top-offset\",\"71\").trim()),Number.isSafeInteger(topOffset)||(topOffset=71)},check=()=>{var t=document.querySelectorAll(\".tc-story-river > .tc-tiddler-frame\");if(0===t.length)update(null);else{for(let e=t.length-1;0<=e;e--)if(!(100<t[e].getBoundingClientRect().top))return void update(t[e]);update(t[0])}},previousFocusedDom=null,update=e=>{var t;e!==previousFocusedDom&&(t=null!==e&&(null!=(t=e.getAttribute(\"data-tiddler-title\"))?t:null==(t=e.querySelector(\".tc-tiddler-title .tc-titlebar .tc-title\"))?void 0:t.textContent)||void 0,$tw.wiki.addTiddler({title:\"$:/temp/focussedTiddler\",text:t||\"\"}),previousFocusedDom&&$tw.utils.removeClass(previousFocusedDom,\"gk0wk-focused-tiddler\"),e&&$tw.utils.addClass(e,\"gk0wk-focused-tiddler\"),previousFocusedDom=e)},name=\"gk0wk-focused-tiddler\",platforms=[\"browser\"],after=[\"story\"],synchronous=!0,startup=()=>{updateTopOffset();let e;window.addEventListener(\"scroll\",()=>{void 0===e&&(e=setTimeout(()=>{e=void 0,check()},250))}),window.addEventListener(\"click\",({target:t})=>{var e,o;if(null!=(o=null==(e=document.querySelector(\".tc-story-river\"))?void 0:e.contains)&&o.call(e,t)){var r=document.querySelectorAll(\".tc-story-river > .tc-tiddler-frame\");for(let e=r.length-1;0<=e;e--)if(r[e].contains(t))return void update(r[e])}}),$tw.wiki.addEventListener(\"change\",e=>{e[\"$:/plugins/Gk0Wk/focused-tiddler/top-offset\"]&&updateTopOffset(),(e[\"$:/HistoryList\"]||e[\"$:/StoryList\"])&&setTimeout(()=>check(),$tw.utils.getAnimationDuration()+100)})};"}}}